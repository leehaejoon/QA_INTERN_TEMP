# 05. ETL + Visualization

## 원하는 데이터를 추출, 변환, 가공하여 데이터베이스에 적재하고, 시각화로 데이터를 분석해보자

### 실습내용

지금까지 실습을 통해, 파일 또는 데이터베이스에 데이터를 저장하고 조회 및 변형해 보았고

웹페이지의 데이터를 긁어와보고, 작성한 프로그램이 정상적으로 동작하는지 테스트 코드도 작성해 보았습니다.


이번엔 지금까지 실습한 내용을 바탕으로 기본적인 ETL 프로세스와 시각화를 구현해 보도록 하겠습니다.

지금까지 했던 부분을 연결시키는 과정이라 크게 부담가지시 않아도 됩니다! (아마도)

<br/>


ETL은 추출(Extraction), 변형(Transformation), 적재(Load) 각 단계를 의미합니다.


바다에서 낚시를 한다고 가정해 보겠습니다.  

큰 그물을 던져서 끌어올리면 각종 물고기 해산물이 딸려 올라옵니다. (추출)

그물로 낚은것들 중에 쓰레기는 버리고 물고기도 저장하기 좋게 손질합니다. (변형)

손질된 물고기를 종류에 따라 박스에 넣고 차곡차곡 창고에 쌓습니다. (적재)

<br/>


즉, ETL은

여러 소스에서 정제되지 않은 다양한 데이터를 수집해서, 

쿼리 엔진이 작동하는 데이터베이스에 저장하기 용이한 형태로 변환, 필터링 하고

정제된 깔끔한 데이터를 데이터베이스에 저장하는 과정입니다.

이렇게 차곡차곡 저장된 데이터는 우리가 필요에 따라 SQL문을 통해 의미있는 정보를 얻을 수 있습니다.
(잘 저장된 창고에서 물고기를 꺼내 맛있는 요리를 먹을 수 있습니다)

모비젠이라는 회사는 매일 쏟아지는 수십억 ~  조 단위의 데이터를 수집해서 수십대 이상의 컴퓨터에
분산에서 저장하는 데이터베이스를 개발하고 이와 관련된 비즈니스를 진행하고 있습니다 ^^

<br/>

실습 단계는 다음과 같습니다

1. 원하는 사이트에서 Selenium 같은 크롤링 모듈을 사용해 데이터를 추출합니다

2. 추출된 데이터를 데이터베이스에 저장하기 용이한 형태로 변환합니다.

3. sqlite 모듈을 사용해서 위에서 변환한 데이터를 적재합니다

4. 적재된 데이터를 sql로 받아오고, Matplotlib이나 Seaborn 모듈을 사용해서 의미있는 분석 결과를 시각화합니다


<br/>

#### 1. 프로그램 동작 예

예를 들어 네이버 실시간 검색 순위 데이터를 크롤링 한다면,

각 연령대별로 1시간마다 검색어 순위 데이터를 크롤링해서 db에 저장합니다.

db에는 해당 데이터를 저장하기위한 테이블을 설계해서 생성해 놓아야 합니다. (create table)

예를 들어 아래와 같이 테이블을 만들어주고 저장할 수 있을 것입니다.

시간 | 연령 | 검색 순위 | 검색어 

수집한 데이터를 통해 INSERT문을 작성해서 데이터를 적재합니다


```
// 예시

insert_query = "insert into search_rank values (timestamp, age, rank, search_word) into ('%s', '%s', '%s', '%s')" %
(timestamp, age, rank, search_word)
```

하루정도 적재된 데이터를 통해 의미있다고 생각되는 통계 데이터를 select 쿼리를 사용해서 추출한 후

시각화 모듈을 사용해서 그래프로 시각화 합니다

예시>  시간별, TOP 5 검색어 막대 그래프 (범례 : 연령)

<br/>

#### 2. 제출방식

완성된 파일은 현재 디렉토리 아래 각자 본인의 이름으로 만들어진 폴더에 넣어주시면 됩니다.

완성 후 시간이 남으면 REST api와 Flask에 대해 공부해보고

Flask로 본인이 만든 웹페이지에 접속하면(GET), sql쿼리를 db에 날려서 원하는 분석 결과를 한 번에
볼수있는 어플리케이션을 만들어도 좋을것 같습니다.
